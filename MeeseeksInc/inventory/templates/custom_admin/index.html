{% extends 'custom_admin/base.html' %} 
{#put this at the top so that the base template is "base.html"#}

{% block content %}
{########################## MESSAGES (SUCCESS / ERRORS) #####################}
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<<<<<<< HEAD

=======
>>>>>>> 0b562cf72616dfbf4cc71ddea05f21e0bed86980
{########################## CREATE ITEMS ##########################}
<h2><a href="{% url 'custom_admin:create_new_item' %}" class="top-menu">Create new item<span class="glyphicon glyphicon-plus"></span></a> </h2>


{########################## ALL ITEMS ##########################}
<h2>All available items</h2>
{% if item_list %}

<table cellspacing='0' cellpadding='1' border='1'>
	<tr>
		<td>
			<div style="overflow:auto; height:160px">
				<table cellspacing='0' cellpadding='1' border='1'>
					{% for item in item_list %}
						<tr>
							<td style="padding-right: 10px;"><a href="{% url 'inventory:detail' item.item_id %}">{{ item.item_name }}</a></td>
							<td style="padding-right: 10px;">{{ item.quantity }}</td>
						</tr>
					{% endfor %}
				</table>
			</div>
		</td>
	</tr>
</table>
{% endif %}

<<<<<<< HEAD

=======
>>>>>>> 0b562cf72616dfbf4cc71ddea05f21e0bed86980
{########################## ALL REQUESTS, SORTED BY ITEM #####################}
{% for request_tuple in request_list %}
	<h3>Item Name: {{ request_tuple.0 }}</h3>
	<ul>
		{% for request in request_tuple.1 %}
			<li> <a href="{% url 'inventory:request_detail' request.request_id %}" class="top-menu"> Request for {{ request.item_name }}: </a> Quantity= {{ request.request_quantity }} Status= {{ request.status }}</li>
			{% if request.status == "Pending" %}
				Reason: {{ request.reason }}
				{% block comment_accept %}
				<a id = "accept" request-id="{{ request.request_id }}" class="top-menu">Approve this request<span class="glyphicon glyphicon-plus"></span></a>
				{% endblock comment_accept %}
				{% block comment_deny %}
				<a id = "deny" request-id="{{ request.request_id }}" class="top-menu">Deny this request<span class="glyphicon glyphicon-plus"></span></a>	
				{% endblock comment_deny %}
			{% endif %}
		{% endfor %}
	</ul>
{% endfor %}
<a href="{% url 'custom_admin:approve_all_requests' %}" class="top-menu">Approve all requests<span class="glyphicon glyphicon-plus"></span></a>	
<a href="{% url 'custom_admin:deny_all_requests' %}" class="top-menu">Deny all requests<span class="glyphicon glyphicon-plus"></span></a>	

{########################## DISBURSEMENTS #####################}
{% if disbursed_list %}
	<h2>Disbursed by you</h2>
	{% for disbursed in disbursed_list %}
		<li> Disbursed {{ disbursed.item_name }} to {{ disbursed.user_name }} by {{ disbursed.admin_name }} @ {{ disbursed.time_disbursed }} </li>
	{% endfor %}
{% endif %}
{#<a href="{% url 'custom_admin:post_new_disburse' %}" class="top-menu">Directly disburse Items to Users here<span class="glyphicon glyphicon-plus"></span></a>	#}
{% block modal %}
<button id="comment-button" class="btn btn-large">Directly disburse Items to Users here</button>
{% endblock modal %}

{############################# REQUEST DENIAL COMMENT MODAL LOGIC ##############################}
<div id="form-modal-deny" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Comment for Request Deny</h4>
            </div>
            <div id="form-modal-body-deny" class="modal-body">
                <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal --> 
{% block js-deny %}
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script>
    $('#deny').click(function() {
    	request_id = $('#deny').attr("request-id"); // should give me request_id to pass into modal / form
        $('#form-modal-body-deny').load(('request/deny/addcomment/'+request_id), function () {
        	$('#formID-comment-deny').attr("request-comment", request_id);
            $('#form-modal-deny').modal('toggle');
        });
    });
</script>
{% endblock js-deny %}

{############################# REQUEST ACCEPT COMMENT MODAL LOGIC ##############################}
<div id="form-modal-accept" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Comment for Request Accept</h4>
            </div>
            <div id="form-modal-body-accept" class="modal-body">
                <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal --> 
{% block js-approve %}
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script>
    $('#accept').click(function() {
    	request_id = $('#accept').attr("request-id"); // should give me request_id to pass into modal / form
        $('#form-modal-body-accept').load(('request/accept/addcomment/'+request_id), function () {
        	$('#formID-comment-accept').attr("request-comment", request_id);
            $('#form-modal-accept').modal('toggle');
        });
    });
</script>
{% endblock js-approve %}

{############################# DIRECT DISBURSEMENT MODAL LOGIC ##############################}
<div id="form-modal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Direct Disbursement</h4>
            </div>
            <div id="form-modal-body" class="modal-body">
                <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal --> 
{% block js %}
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script>
    $('#comment-button').click(function() {
        $('#form-modal-body').load('disburse/item', function () {
            $('#form-modal').modal('toggle');
        });
    });
</script>
{% endblock js %}
{% endblock %}


