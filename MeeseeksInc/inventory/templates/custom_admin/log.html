{% extends 'custom_admin/base.html' %} 
{% load static %}
{#put this at the top so that the base template is "base.html"#}


{% block content %}

<h2>Log</h2>
{% if log_list %}
	<table id="log-table" class="table table-hover table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
            <tr>
            <th>Nature of event</th>
			<th>Initiated by</th>
			<th>Item</th>
			<th>Affected User</th>
			<th>Type of Change</th>
			<th>Time Occurred</th>
		</tr>
        </thead>
        
        <tbody>
            {% for instance in log_list %}
				<tr>
					{% if instance.reference_id in request_list and instance.nature_of_event == "Request" %}
						<td><a href="{% url 'inventory:request_detail' instance.reference_id %}">Request</a></td>
					{% else %}
						<td>{{ instance.nature_of_event }}</td>
					{% endif %}
					<td>{{ instance.initiating_user }}</td>
					<td>{{ instance.item_name }}</td>
					<td>{{ instance.affected_user }}</td>
					<td>{{ instance.change_occurred }}</td>
					<td>{{ instance.time_occurred }}</td>
				</tr>
			{% endfor %}
        </tbody>
    </table>
    
{% else %}
	<h3>There are no log events to display!</h3>
{% endif %}


{########### TODO: FIGURE OUT WHY I NEED THESE JAVASCRIPT FILES HERE FOR IT TO LOAD DATATABLES PROPERLY #######}
<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="http://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css"></style>
<script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
 
 <script>
	$(document).ready(function(){
	    $('#log-table').DataTable({
	        "order": [[ 5, "desc" ]],
	        //"serverSide": true,
		    //"processing": true,
		    //"paging": true,
		    //"searching": { "regex": true },
		    //"ajax": {
		    //    "type": "GET",
		    //    "url": '{% url 'inventory:api_log_list' %}',
		     //   "dataType": "json",
		     //   "contentType": 'application/json; charset=utf-8',
		        //"data": function() { 
		        //			var info = $('#log-table').DataTable().page.info();
		        //			return {'limit': 10,
		        //		 			'offset': info*10};
		        //		},
		        //"success": function(json) {
		        //    console.log(json);
       			//}
       		//}
	    });

	});
	</script>

{% endblock %}