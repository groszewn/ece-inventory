{% extends 'inventory/base.html' %} 
{#put this at the top so that the base template is "base.html"#}
  
{% block content %}

{% if item_list %}
	<h2>All Inventory Items</h2>
	<form method="POST" class="post-form">{% csrf_token %}
	 {{ form.Tag2Include.label }} {{ form.Tag2Include }}
	 {{ form.Tag2Exclude.label }} {{ form.Tag2Exclude }}
	<button type="submit" class="save btn btn-default">Tag Filter</button>
	</form>
	
	<table id="inventory-item" class="table table-hover table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
            <tr>
			<th>Item Name</th>
			<th># Item</th>
			<th>Item Location</th>
			<th>Item Model Number</th>
			<th>Item Description</th>
		</tr>
        </thead>
        {% block item_filter_table%}
        <tbody>
            {% for item in item_list %}
				<tr>
					<td><a href="{% url 'inventory:detail' item.item_id %}">{{ item.item_name }}</a></td>
					<td>{{ item.quantity }}</td>
					<td>{{ item.location }}</td>
					<td>{{ item.model_number }}</td>
					<td>{{ item.description }}</td>
				</tr>
			{% endfor %}
			
        </tbody>
        {% endblock %}
    </table>
	
	
	{% if request_list %}
		<h2>Requests made by you</h2>
		<ul class="nav nav-tabs">
		  <li><a href="#all" data-toggle="tab">All Requests</a></li>
		  <li><a href="#accepted" data-toggle="tab">Approved</a></li>
		  <li class="active"><a href="#pending" data-toggle="tab">Pending</a></li>
		  <li><a href="#denied" data-toggle="tab">Denied</a></li>
		</ul>
		<div class="tab-content">
	        <div class="tab-pane" id="all">
				<table id="inventory-request-all" class="table table-hover table-striped table-bordered" cellspacing="0" width="100%">
		        <thead>
		            <tr>
					<th>Request</th>
					<th># Item</th>
					<th>Status</th>
					<th>Student Reason</th>
					<th>Admin Comment</th>
				</tr>
		        </thead>
		        <tbody>
		        	{% for request in request_list %}
		        		<tr>
							<td><a href="{% url 'inventory:request_detail' request.request_id %}">Request for {{ request.item_name }}:</a></td>
							<td>{{ request.request_quantity }}</td>
							<td>{{ request.status }}</td>
							<td>{{ request.reason}}</td>
							<td>{{ request.comment }}</td>
						</tr>
					{% endfor %}
		        </tbody>
		    </table>
	        </div>
	        <div class="tab-pane" id="accepted">
				<table id="inventory-request-approved" class="table table-hover table-striped table-bordered" cellspacing="0" width="100%">
		        <thead>
		            <tr>
					<th>Request</th>
					<th># Item</th>
					<th>Status</th>
					<th>Student Reason</th>
					<th>Admin Comment</th>
				</tr>
		        </thead>
		        <tbody>
		        	{% for request in approved_request_list %}
		        		<tr>
							<td><a href="{% url 'inventory:request_detail' request.request_id %}">Request for {{ request.item_name }}:</a></td>
							<td>{{ request.request_quantity }}</td>
							<td>{{ request.status }}</td>
							<td>{{ request.reason}}</td>
							<td>{{ request.comment }}</td>
						</tr>
					{% endfor %}
		        </tbody>
		    </table>
	        </div>
	        <div class="tab-pane active" id="pending">
				<table id="inventory-request-pending" class="table table-hover table-striped table-bordered" cellspacing="0" width="100%">
		        <thead>
		            <tr>
					<th>Request</th>
					<th># Item</th>
					<th>Status</th>
					<th>Student Reason</th>
					<th>Admin Comment</th>
					<th>Actions</th>
				</tr>
		        </thead>
		        <tbody>
		        	{% for request in pending_request_list %}
		        		<tr>
							<td><a href="{% url 'inventory:request_detail' request.request_id %}">Request for {{ request.item_name }}:</a></td>
							<td>{{ request.request_quantity }}</td>
							<td>{{ request.status }}</td>
							<td>{{ request.reason}}</td>
							<td>{{ request.comment }}</td>
							<td>
								<a href="{% url 'inventory:request_edit' request.request_id %}" class="btn btn-info">Edit</a>
								<a onclick="return confirm('Confirm request cancel?')" href="{% url 'inventory:request_cancel' request.request_id %}" class="btn btn-danger">Cancel</a>
							</td>
						</tr>
					{% endfor %}
		        </tbody>
		    </table>
	        </div>
	        <div class="tab-pane" id="denied">
				<table id="inventory-request-denied" class="table table-hover table-striped table-bordered" cellspacing="0" width="100%">
		        <thead>
		            <tr>
					<th>Request</th>
					<th># Item</th>
					<th>Status</th>
					<th>Student Reason</th>
					<th>Admin Comment</th>
				</tr>
		        </thead>
		        <tbody>
		        	{% for request in denied_request_list %}
		        		<tr>
							<td><a href="{% url 'inventory:request_detail' request.request_id %}">Request for {{ request.item_name }}:</a></td>
							<td>{{ request.request_quantity }}</td>
							<td>{{ request.status }}</td>
							<td>{{ request.reason}}</td>
							<td>{{ request.comment }}</td>
						</tr>
					{% endfor %}
		        </tbody>
		    </table>
	        </div>
		</div>
	{% endif %}
	
	<a class="btn btn-default" href="{% url 'inventory:post_new_request' %}" role="button">Request an Item</a>
	
	{% if disbursed_list %}
		<h2>Disbursed to you</h2>
		<table id="inventory-disbursed" class="table table-hover table-striped table-bordered" cellspacing="0" width="100%">
		        <thead>
		            <tr>
					<th>Item Name</th>
					<th># Item</th>
					<th>Disbursed by</th>
					<th>Admin Comment</th>
					<th>Time Disbursed</th>
				</tr>
		        </thead>
		        <tbody>
		        	{% for disbursed in disbursed_list %}
		        		<tr>
							<td>{{ disbursed.item_name }}</td>
							<td>{{ disbursed.total_quantity }}</td>
							<td>{{ disbursed.admin_name }}</td>
							<td>{{ disbursed.comment}}</td>
							<td>{{ disbursed.time_disbursed }}</td>
						</tr>
					{% endfor %}
		        </tbody>
		    </table>
	{% endif %}
	
    <script>
	$(document).ready(function(){
	    $('#inventory-request-all').dataTable();
	    $('#inventory-request-approved').dataTable();
	    $('#inventory-request-pending').dataTable();
	    $('#inventory-request-denied').dataTable();
	    $('#inventory-disbursed').dataTable();
	    $('#inventory-item').dataTable();
	    
	});
	</script>
{% else %}
	<p class="lead" style="padding: 15px 15px">No items are available.</p>
	
{% endif %}

{% endblock %}
